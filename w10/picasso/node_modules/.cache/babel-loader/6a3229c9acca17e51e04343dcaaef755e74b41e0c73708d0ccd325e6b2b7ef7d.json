{"ast":null,"code":"import React, { forwardRef, useMemo, useRef, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useHasMultilineCounter } from '@toptal/picasso-shared';\nimport cx from 'classnames';\nimport hastUtilToHtml from 'hast-util-to-html';\nimport hastSanitize from 'hast-util-sanitize';\nimport noop from '../utils/noop';\nimport Container from '../Container';\nimport QuillEditor from '../QuillEditor';\nimport InputMultilineAdornment from '../InputMultilineAdornment';\nimport Toolbar from '../RichTextEditorToolbar';\nimport styles from './styles';\nimport { useTextEditorState, useOnSelectionChange, useOnTextFormat, useOnFocus, useToolbarHandlers, useCounter } from './hooks';\nimport { usePropDeprecationWarning } from '../utils/use-deprecation-warnings';\nconst useStyles = makeStyles(styles, {\n  name: 'RichTextEditor'\n});\nexport const RichTextEditor = forwardRef(function RichTextEditor(props, ref) {\n  const {\n    'data-testid': dataTestId,\n    plugins,\n    autoFocus = false,\n    className,\n    defaultValue,\n    disabled,\n    id,\n    onChange = noop,\n    onFocus = noop,\n    onBlur = noop,\n    placeholder,\n    minLength,\n    maxLength,\n    minLengthMessage,\n    maxLengthMessage,\n    style,\n    status,\n    testIds,\n    hiddenInputId,\n    setHasMultilineCounter,\n    name\n  } = props;\n  const classes = useStyles();\n  const toolbarRef = useRef(null);\n  const editorRef = useRef(null);\n  const wrapperRef = useRef(null);\n  const {\n    dispatch,\n    state\n  } = useTextEditorState();\n  usePropDeprecationWarning({\n    props,\n    name: 'error',\n    componentName: 'RichTextEditor',\n    description: 'Use the `status` prop instead. `error` is deprecated and will be removed in the next major release.'\n  });\n  const {\n    handleSelectionChange\n  } = useOnSelectionChange({\n    dispatch\n  });\n  const {\n    handleTextFormat\n  } = useOnTextFormat({\n    dispatch\n  });\n  const {\n    handleBold,\n    handleItalic,\n    handleHeader,\n    handleOrdered,\n    handleUnordered,\n    handleLink\n  } = useToolbarHandlers({\n    editorRef,\n    handleTextFormat,\n    format: state.toolbar.format\n  });\n  const {\n    isEditorFocused,\n    handleFocus,\n    handleBlur\n  } = useOnFocus({\n    autoFocus,\n    editorRef,\n    toolbarRef,\n    wrapperRef,\n    onFocus,\n    onBlur,\n    dispatch\n  });\n  const [defaultValueInHtml] = useState(() => defaultValue ? hastUtilToHtml(hastSanitize(defaultValue)) : defaultValue);\n  const {\n    counterMessage,\n    counterError,\n    handleCounterMessage\n  } = useCounter({\n    minLength,\n    maxLength,\n    minLengthMessage,\n    maxLengthMessage\n  });\n  // Disabled the exhaustive deps rule to allow users to\n  // declare prop like \"plugins={[]}\" instead of having to\n  // declare the array outside the component level\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const memoizedPlugins = useMemo(() => plugins, []);\n  useHasMultilineCounter(name, !!counterMessage, setHasMultilineCounter);\n  return React.createElement(React.Fragment, null, React.createElement(Container, {\n    className: cx(classes.editorWrapper, {\n      [classes.disabled]: disabled,\n      [classes.focused]: isEditorFocused,\n      [classes.error]: status === 'error'\n    }, className),\n    tabIndex: -1,\n    style: style,\n    ref: node => {\n      if (typeof ref === 'function') {\n        ref(node);\n      } else if (ref != null) {\n        ref.current = node;\n      }\n      wrapperRef.current = node;\n    },\n    \"data-testid\": (testIds === null || testIds === void 0 ? void 0 : testIds.wrapper) || dataTestId,\n    onFocus: handleFocus,\n    onBlur: handleBlur\n  }, React.createElement(Toolbar, {\n    ref: toolbarRef,\n    disabled: disabled || state.toolbar.disabled,\n    id: id,\n    format: state.toolbar.format,\n    onBoldClick: handleBold,\n    onItalicClick: handleItalic,\n    onUnorderedClick: handleUnordered,\n    onOrderedClick: handleOrdered,\n    onHeaderChange: handleHeader,\n    onLinkClick: handleLink,\n    plugins: memoizedPlugins,\n    testIds: {\n      headerSelect: testIds === null || testIds === void 0 ? void 0 : testIds.headerSelect,\n      boldButton: testIds === null || testIds === void 0 ? void 0 : testIds.boldButton,\n      italicButton: testIds === null || testIds === void 0 ? void 0 : testIds.italicButton,\n      unorderedListButton: testIds === null || testIds === void 0 ? void 0 : testIds.unorderedListButton,\n      orderedListButton: testIds === null || testIds === void 0 ? void 0 : testIds.orderedListButton\n    }\n  }), React.createElement(QuillEditor, {\n    ref: editorRef,\n    disabled: !!disabled,\n    \"data-testid\": testIds === null || testIds === void 0 ? void 0 : testIds.editor,\n    id: id,\n    isFocused: isEditorFocused,\n    placeholder: placeholder,\n    onTextLengthChange: handleCounterMessage,\n    onTextFormat: handleTextFormat,\n    onSelectionChange: handleSelectionChange,\n    onTextChange: onChange,\n    defaultValue: defaultValueInHtml,\n    plugins: memoizedPlugins\n  }), hiddenInputId && enableFocusOnLabelClick(hiddenInputId)), counterMessage && React.createElement(InputMultilineAdornment, {\n    error: counterError\n  }, counterMessage));\n});\nconst hiddenInputStyle = {\n  position: 'absolute',\n  opacity: 0,\n  zIndex: -1\n};\n// Native `for` attribute on label does not work for div target\nconst enableFocusOnLabelClick = hiddenInputId => React.createElement(\"input\", {\n  type: 'text',\n  id: hiddenInputId,\n  style: hiddenInputStyle\n});\nRichTextEditor.defaultProps = {\n  autoFocus: false,\n  onChange: noop,\n  onFocus: noop,\n  onBlur: noop,\n  disabled: false,\n  status: 'default'\n};\nRichTextEditor.displayName = 'RichTextEditor';\nexport default RichTextEditor;","map":{"version":3,"names":["React","forwardRef","useMemo","useRef","useState","makeStyles","useHasMultilineCounter","cx","hastUtilToHtml","hastSanitize","noop","Container","QuillEditor","InputMultilineAdornment","Toolbar","styles","useTextEditorState","useOnSelectionChange","useOnTextFormat","useOnFocus","useToolbarHandlers","useCounter","usePropDeprecationWarning","useStyles","name","RichTextEditor","props","ref","dataTestId","plugins","autoFocus","className","defaultValue","disabled","id","onChange","onFocus","onBlur","placeholder","minLength","maxLength","minLengthMessage","maxLengthMessage","style","status","testIds","hiddenInputId","setHasMultilineCounter","classes","toolbarRef","editorRef","wrapperRef","dispatch","state","componentName","description","handleSelectionChange","handleTextFormat","handleBold","handleItalic","handleHeader","handleOrdered","handleUnordered","handleLink","format","toolbar","isEditorFocused","handleFocus","handleBlur","defaultValueInHtml","counterMessage","counterError","handleCounterMessage","memoizedPlugins","createElement","Fragment","editorWrapper","focused","error","tabIndex","node","current","wrapper","onBoldClick","onItalicClick","onUnorderedClick","onOrderedClick","onHeaderChange","onLinkClick","headerSelect","boldButton","italicButton","unorderedListButton","orderedListButton","editor","isFocused","onTextLengthChange","onTextFormat","onSelectionChange","onTextChange","enableFocusOnLabelClick","hiddenInputStyle","position","opacity","zIndex","type","defaultProps","displayName"],"sources":["../../src/RichTextEditor/RichTextEditor.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}