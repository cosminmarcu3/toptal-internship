{"ast":null,"code":"/* eslint-disable max-statements */\nimport { useState, useCallback, useEffect, useMemo } from 'react';\nimport { getMultipleSelection, getSingleSelection, getSelectedOptions, DEFAULT_SEARCH_THRESHOLD, DEFAULT_LIMIT, filterOptions, flattenOptions, limitOptions } from '../../utils';\nimport useHighlightedIndex from '../use-highlighted-index';\nexport const EMPTY_INPUT_VALUE = '';\nconst useSelectState = props => {\n  const {\n    getDisplayValue,\n    filterFlatOptions,\n    options = [],\n    disabled = false,\n    multiple,\n    value: valueProp,\n    searchThreshold = DEFAULT_SEARCH_THRESHOLD,\n    limit = DEFAULT_LIMIT\n  } = props;\n  const flatOptions = useMemo(() => flattenOptions(options), [options]);\n  const selectedOptions = useMemo(() => getSelectedOptions(flatOptions, valueProp), [flatOptions, valueProp]);\n  const selection = useMemo(() => multiple ? getMultipleSelection(selectedOptions) : getSingleSelection(selectedOptions[0]), [selectedOptions, multiple]);\n  const displayValue = useMemo(() => selection.display(getDisplayValue), [selection, getDisplayValue]);\n  const [filterOptionsValue, setFilterOptionsValue] = useState(EMPTY_INPUT_VALUE);\n  const filteredOptions = useMemo(() => filterOptions({\n    options,\n    filterOptionsValue,\n    getDisplayValue,\n    filterFlatOptions\n  }), [options, filterOptionsValue, getDisplayValue, filterFlatOptions]);\n  const filteredLimitedOptions = useMemo(() => limitOptions({\n    options: filteredOptions,\n    limit\n  }), [filteredOptions, limit]);\n  const filteredLimitedFlatOptions = useMemo(() => flattenOptions(filteredLimitedOptions), [filteredLimitedOptions]);\n  const emptySelectValue = useMemo(() => multiple ? [] : '', [multiple]);\n  // Search should be shown when limit < searchThreshold\n  // otherwise user might not be able to search through long list\n  const showSearch = flatOptions.length >= Math.min(searchThreshold, limit);\n  const [isOpen, setOpen] = useState(false);\n  const canOpen = !isOpen && !disabled;\n  const [highlightedIndex, setHighlightedIndex] = useHighlightedIndex({\n    flatOptions: filteredLimitedFlatOptions,\n    selection,\n    isOpen\n  });\n  const close = useCallback(() => {\n    setOpen(false);\n  }, []);\n  const open = useCallback(() => {\n    setOpen(true);\n  }, []);\n  useEffect(() => {\n    // we have to close menu if select has became disabled\n    if (disabled && isOpen) {\n      close();\n    }\n  }, [disabled, isOpen, close]);\n  return Object.assign(Object.assign({}, props), {\n    selectedOptions,\n    // TODO: keep consistent naming\n    filteredOptions: filteredLimitedOptions,\n    isOpen,\n    canOpen,\n    open,\n    close,\n    highlightedIndex,\n    closeOnEnter: !multiple,\n    setHighlightedIndex,\n    showSearch,\n    filterOptionsValue,\n    displayValue,\n    selection,\n    emptySelectValue,\n    setFilterOptionsValue\n  });\n};\nexport default useSelectState;","map":{"version":3,"names":["useState","useCallback","useEffect","useMemo","getMultipleSelection","getSingleSelection","getSelectedOptions","DEFAULT_SEARCH_THRESHOLD","DEFAULT_LIMIT","filterOptions","flattenOptions","limitOptions","useHighlightedIndex","EMPTY_INPUT_VALUE","useSelectState","props","getDisplayValue","filterFlatOptions","options","disabled","multiple","value","valueProp","searchThreshold","limit","flatOptions","selectedOptions","selection","displayValue","display","filterOptionsValue","setFilterOptionsValue","filteredOptions","filteredLimitedOptions","filteredLimitedFlatOptions","emptySelectValue","showSearch","length","Math","min","isOpen","setOpen","canOpen","highlightedIndex","setHighlightedIndex","close","open","Object","assign","closeOnEnter"],"sources":["../../../../src/SelectBase/hooks/use-select-state/use-select-state.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}