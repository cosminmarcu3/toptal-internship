{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport React, { forwardRef, useContext, useMemo, useRef, useState } from 'react';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Grow from '@material-ui/core/Grow';\nimport RootRef from '@material-ui/core/RootRef';\nimport { makeStyles } from '@material-ui/core/styles';\nimport cx from 'classnames';\nimport { spacingToRem } from '@toptal/picasso-shared';\nimport Popper from '../Popper';\nimport Paper from '../Paper';\nimport styles from './styles';\nimport noop from '../utils/noop';\nconst DropdownContext = React.createContext(null);\nexport const useDropdownContext = () => {\n  const context = useContext(DropdownContext);\n  if (!context) {\n    throw new Error('Dropdown compound components cannot be rendered outside the Dropdown component');\n  }\n  return context;\n};\nconst useStyles = makeStyles(styles, {\n  name: 'PicassoDropdown'\n});\n// eslint-disable-next-line react/display-name\nexport const Dropdown = forwardRef(function Dropdown(props, ref) {\n  const {\n      className,\n      style,\n      children,\n      content,\n      offset,\n      placement,\n      disableAutoClose,\n      disableAutoFocus,\n      disablePortal,\n      popperOptions,\n      popperProps,\n      keepMounted,\n      onOpen = noop,\n      popperContainer,\n      onClose = noop,\n      contentStyle,\n      // Avoid passing external classes inside the rest props\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      classes: externalClasses,\n      contentOverflow = 'scroll'\n    } = props,\n    rest = __rest(props, [\"className\", \"style\", \"children\", \"content\", \"offset\", \"placement\", \"disableAutoClose\", \"disableAutoFocus\", \"disablePortal\", \"popperOptions\", \"popperProps\", \"keepMounted\", \"onOpen\", \"popperContainer\", \"onClose\", \"contentStyle\", \"classes\", \"contentOverflow\"]);\n  const classes = useStyles(props);\n  const contentRef = useRef();\n  const [anchorEl, setAnchorEl] = useState();\n  const [isOpen, setIsOpen] = useState(false);\n  const handleAnchorClick = event => {\n    if (isOpen) {\n      close();\n    } else {\n      open(event);\n    }\n  };\n  const handleContentKeyDown = event => {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n    }\n    // Always close menu regardless of disableAutoClose\n    if (event.key === 'Escape') {\n      forceClose();\n    }\n    if (event.key === 'Enter') {\n      close();\n    }\n    if (event.key === ' ') {\n      close();\n    }\n  };\n  const open = event => {\n    setAnchorEl(event.currentTarget);\n    setIsOpen(true);\n    onOpen();\n  };\n  const close = () => {\n    if (disableAutoClose) {\n      return;\n    }\n    forceClose();\n  };\n  const forceClose = () => {\n    setAnchorEl(undefined);\n    setIsOpen(false);\n    onClose();\n  };\n  const focus = () => {\n    if (disableAutoFocus) {\n      return;\n    }\n    if (!contentRef || !contentRef.current) {\n      return;\n    }\n    const {\n      firstChild\n    } = contentRef.current;\n    // TODO: add focusable interface to Picasso.Menu and other components that expose focus\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    if (firstChild && firstChild.focus) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return firstChild.focus();\n    }\n    if (contentRef.current.focus) {\n      return contentRef.current.focus();\n    }\n  };\n  const paperMargins = useMemo(() => {\n    if (offset) {\n      return Object.assign(Object.assign(Object.assign(Object.assign({}, offset.top && {\n        marginTop: spacingToRem(offset.top)\n      }), offset.bottom && {\n        marginBottom: spacingToRem(offset.bottom)\n      }), offset.left && {\n        marginLeft: spacingToRem(offset.left)\n      }), offset.right && {\n        marginRight: spacingToRem(offset.right)\n      });\n    }\n  }, [offset]);\n  // here you can expose other methods, states to child components\n  const context = {\n    close: () => forceClose()\n  };\n  const handleClickAway = event => {\n    const target = event.target;\n    const isAnchorTapEvent = anchorEl && target instanceof Node && anchorEl.contains(target);\n    if (isAnchorTapEvent) {\n      return;\n    }\n    forceClose();\n  };\n  return React.createElement(\"div\", Object.assign({}, rest, {\n    ref: ref,\n    className: cx(classes.root, className),\n    style: style\n  }), React.createElement(\"div\", {\n    className: classes.anchor,\n    onClick: handleAnchorClick\n  }, typeof children === 'function' ? children({\n    isOpen\n  }) : children), (isOpen || keepMounted) && React.createElement(Popper, Object.assign({\n    className: classes.popper,\n    anchorEl: anchorEl !== null && anchorEl !== void 0 ? anchorEl : null,\n    popperOptions: Object.assign({\n      onCreate: focus,\n      /*\n      Fixes https://github.com/toptal/picasso/pull/2124#issuecomment-894341054\n      When the anchor goes above the viewport, popper goes to infinite flipping.\n      flipped: true -> flipped: false -> flipped: true -> ...\n      */\n      modifiers: {\n        flip: {\n          enabled: contentOverflow !== 'visible'\n        }\n      }\n    }, popperOptions),\n    placement: placement,\n    style: paperMargins,\n    disablePortal: disablePortal,\n    keepMounted: keepMounted,\n    autoWidth: false,\n    open: isOpen,\n    enableCompactMode: true,\n    container: popperContainer\n  }, popperProps), React.createElement(ClickAwayListener, {\n    onClickAway: handleClickAway\n  }, React.createElement(\"div\", {\n    onClick: close\n  }, React.createElement(Grow, {\n    in: isOpen,\n    appear: true\n  }, React.createElement(Paper, {\n    style: contentStyle,\n    className: cx(classes.content, {\n      [classes.contentVisible]: contentOverflow === 'visible'\n    }),\n    onKeyDown: handleContentKeyDown,\n    elevation: 2\n  }, React.createElement(DropdownContext.Provider, {\n    value: context\n  }, React.createElement(RootRef, {\n    rootRef: contentRef\n  }, content))))))));\n});\nDropdown.defaultProps = {\n  disableAutoClose: false,\n  disableAutoFocus: true,\n  disablePortal: false,\n  keepMounted: false,\n  onClose: noop,\n  onOpen: noop,\n  placement: 'bottom-end',\n  popperOptions: {}\n};\nDropdown.displayName = 'Dropdown';\nexport default Dropdown;","map":{"version":3,"names":["React","forwardRef","useContext","useMemo","useRef","useState","ClickAwayListener","Grow","RootRef","makeStyles","cx","spacingToRem","Popper","Paper","styles","noop","DropdownContext","createContext","useDropdownContext","context","Error","useStyles","name","Dropdown","props","ref","className","style","children","content","offset","placement","disableAutoClose","disableAutoFocus","disablePortal","popperOptions","popperProps","keepMounted","onOpen","popperContainer","onClose","contentStyle","classes","externalClasses","contentOverflow","rest","__rest","contentRef","anchorEl","setAnchorEl","isOpen","setIsOpen","handleAnchorClick","event","close","open","handleContentKeyDown","key","preventDefault","forceClose","currentTarget","undefined","focus","current","firstChild","paperMargins","Object","assign","top","marginTop","bottom","marginBottom","left","marginLeft","right","marginRight","handleClickAway","target","isAnchorTapEvent","Node","contains","createElement","root","anchor","onClick","popper","onCreate","modifiers","flip","enabled","autoWidth","enableCompactMode","container","onClickAway","in","appear","contentVisible","onKeyDown","elevation","Provider","value","rootRef","defaultProps","displayName"],"sources":["../../src/Dropdown/Dropdown.tsx"],"sourcesContent":[null],"mappings":";;;;;;;;AAAA,OAAOA,KAAK,IACVC,UAAU,EAGVC,UAAU,EACVC,OAAO,EACPC,MAAM,EACNC,QAAQ,QACH,OAAO;AACd,OAAOC,iBAAiB,MAAM,qCAAqC;AACnE,OAAOC,IAAI,MAAM,wBAAwB;AAGzC,OAAOC,OAAO,MAAM,2BAA2B;AAC/C,SAASC,UAAU,QAAe,0BAA0B;AAC5D,OAAOC,EAAE,MAAM,YAAY;AAC3B,SACEC,YAAY,QAGP,wBAAwB;AAE/B,OAAOC,MAAM,MAAM,WAAW;AAC9B,OAAOC,KAAK,MAAM,UAAU;AAC5B,OAAOC,MAAsB,MAAM,UAAU;AAC7C,OAAOC,IAAI,MAAM,eAAe;AA4ChC,MAAMC,eAAe,GAAGhB,KAAK,CAACiB,aAAa,CAAsB,IAAI,CAAC;AAEtE,OAAO,MAAMC,kBAAkB,GAAGA,CAAA,KAAK;EACrC,MAAMC,OAAO,GAAGjB,UAAU,CAACc,eAAe,CAAC;EAE3C,IAAI,CAACG,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CACb,gFAAgF,CACjF;;EAGH,OAAOD,OAAO;AAChB,CAAC;AAED,MAAME,SAAS,GAAGZ,UAAU,CAAeK,MAAM,EAAE;EACjDQ,IAAI,EAAE;CACP,CAAC;AAEF;AACA,OAAO,MAAMC,QAAQ,GAAGtB,UAAU,CAAwB,SAASsB,QAAQA,CACzEC,KAAK,EACLC,GAAG;EAEH,MAAM;MACJC,SAAS;MACTC,KAAK;MACLC,QAAQ;MACRC,OAAO;MACPC,MAAM;MACNC,SAAS;MACTC,gBAAgB;MAChBC,gBAAgB;MAChBC,aAAa;MACbC,aAAa;MACbC,WAAW;MACXC,WAAW;MACXC,MAAM,GAAGvB,IAAI;MACbwB,eAAe;MACfC,OAAO,GAAGzB,IAAI;MACd0B,YAAY;MACZ;MACA;MACAC,OAAO,EAAEC,eAAe;MACxBC,eAAe,GAAG;IAAQ,IAExBpB,KAAK;IADJqB,IAAI,GAAAC,MAAA,CACLtB,KAAK,EAtBH,kQAsBL,CAAQ;EACT,MAAMkB,OAAO,GAAGrB,SAAS,CAACG,KAAK,CAAC;EAEhC,MAAMuB,UAAU,GAAG3C,MAAM,EAAe;EACxC,MAAM,CAAC4C,QAAQ,EAAEC,WAAW,CAAC,GAAG5C,QAAQ,EAA8B;EACtE,MAAM,CAAC6C,MAAM,EAAEC,SAAS,CAAC,GAAG9C,QAAQ,CAAC,KAAK,CAAC;EAE3C,MAAM+C,iBAAiB,GACrBC,KAAmD,IACjD;IACF,IAAIH,MAAM,EAAE;MACVI,KAAK,EAAE;KACR,MAAM;MACLC,IAAI,CAACF,KAAK,CAAC;;EAEf,CAAC;EAED,MAAMG,oBAAoB,GAAIH,KAAuC,IAAI;IACvE,IAAIA,KAAK,CAACI,GAAG,KAAK,KAAK,EAAE;MACvBJ,KAAK,CAACK,cAAc,EAAE;;IAGxB;IACA,IAAIL,KAAK,CAACI,GAAG,KAAK,QAAQ,EAAE;MAC1BE,UAAU,EAAE;;IAGd,IAAIN,KAAK,CAACI,GAAG,KAAK,OAAO,EAAE;MACzBH,KAAK,EAAE;;IAGT,IAAID,KAAK,CAACI,GAAG,KAAK,GAAG,EAAE;MACrBH,KAAK,EAAE;;EAEX,CAAC;EAED,MAAMC,IAAI,GAAIF,KAAmD,IAAI;IACnEJ,WAAW,CAACI,KAAK,CAACO,aAAa,CAAC;IAChCT,SAAS,CAAC,IAAI,CAAC;IACfb,MAAM,EAAE;EACV,CAAC;EAED,MAAMgB,KAAK,GAAGA,CAAA,KAAK;IACjB,IAAItB,gBAAgB,EAAE;MACpB;;IAEF2B,UAAU,EAAE;EACd,CAAC;EAED,MAAMA,UAAU,GAAGA,CAAA,KAAK;IACtBV,WAAW,CAACY,SAAS,CAAC;IACtBV,SAAS,CAAC,KAAK,CAAC;IAChBX,OAAO,EAAE;EACX,CAAC;EAED,MAAMsB,KAAK,GAAGA,CAAA,KAAK;IACjB,IAAI7B,gBAAgB,EAAE;MACpB;;IAGF,IAAI,CAACc,UAAU,IAAI,CAACA,UAAU,CAACgB,OAAO,EAAE;MACtC;;IAGF,MAAM;MAAEC;IAAU,CAAE,GAAGjB,UAAU,CAACgB,OAAO;IACzC;IACA;IACA;IAEA,IAAIC,UAAU,IAAIA,UAAU,CAACF,KAAK,EAAE;MAClC;MACA;MACA,OAAOE,UAAU,CAACF,KAAK,EAAE;;IAG3B,IAAIf,UAAU,CAACgB,OAAO,CAACD,KAAK,EAAE;MAC5B,OAAOf,UAAU,CAACgB,OAAO,CAACD,KAAK,EAAE;;EAErC,CAAC;EAED,MAAMG,YAAY,GAAG9D,OAAO,CAAC,MAAK;IAChC,IAAI2B,MAAM,EAAE;MACV,OAAAoC,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACMrC,MAAM,CAACsC,GAAG,IAAI;QAAEC,SAAS,EAAE1D,YAAY,CAACmB,MAAM,CAACsC,GAAG;MAAC,CAAE,CAAC,EACtDtC,MAAM,CAACwC,MAAM,IAAI;QAAEC,YAAY,EAAE5D,YAAY,CAACmB,MAAM,CAACwC,MAAM;MAAC,CAAE,CAAC,EAC/DxC,MAAM,CAAC0C,IAAI,IAAI;QAAEC,UAAU,EAAE9D,YAAY,CAACmB,MAAM,CAAC0C,IAAI;MAAC,CAAE,CAAC,EACzD1C,MAAM,CAAC4C,KAAK,IAAI;QAAEC,WAAW,EAAEhE,YAAY,CAACmB,MAAM,CAAC4C,KAAK;MAAC,CAAE,CAAC;;EAGtE,CAAC,EAAE,CAAC5C,MAAM,CAAC,CAAC;EAEZ;EACA,MAAMX,OAAO,GAAG;IACdmC,KAAK,EAAEA,CAAA,KAAMK,UAAU;GACxB;EAED,MAAMiB,eAAe,GAAIvB,KAAiC,IAAI;IAC5D,MAAMwB,MAAM,GAAGxB,KAAK,CAACwB,MAAM;IAE3B,MAAMC,gBAAgB,GACpB9B,QAAQ,IAAI6B,MAAM,YAAYE,IAAI,IAAI/B,QAAQ,CAACgC,QAAQ,CAACH,MAAM,CAAC;IAEjE,IAAIC,gBAAgB,EAAE;MACpB;;IAGFnB,UAAU,EAAE;EACd,CAAC;EAED,OACE3D,KAAA,CAAAiF,aAAA,QAAAf,MAAA,CAAAC,MAAA,KACMtB,IAAI;IACRpB,GAAG,EAAEA,GAAG;IACRC,SAAS,EAAEhB,EAAE,CAACgC,OAAO,CAACwC,IAAI,EAAExD,SAAS,CAAC;IACtCC,KAAK,EAAEA;EAAK,IAEZ3B,KAAA,CAAAiF,aAAA;IAAKvD,SAAS,EAAEgB,OAAO,CAACyC,MAAM;IAAEC,OAAO,EAAEhC;EAAiB,GACvD,OAAOxB,QAAQ,KAAK,UAAU,GAAGA,QAAQ,CAAC;IAAEsB;EAAM,CAAE,CAAC,GAAGtB,QAAQ,CAC7D,EAEL,CAACsB,MAAM,IAAIb,WAAW,KACrBrC,KAAA,CAAAiF,aAAA,CAACrE,MAAM,EAAAsD,MAAA,CAAAC,MAAA;IACLzC,SAAS,EAAEgB,OAAO,CAAC2C,MAAM;IACzBrC,QAAQ,EAAEA,QAAQ,aAARA,QAAQ,cAARA,QAAQ,GAAI,IAAI;IAC1Bb,aAAa,EAAA+B,MAAA,CAAAC,MAAA;MACXmB,QAAQ,EAAExB,KAAK;MACf;;;;;MAKAyB,SAAS,EAAE;QAAEC,IAAI,EAAE;UAAEC,OAAO,EAAE7C,eAAe,KAAK;QAAS;MAAE;IAAE,GAC5DT,aAAa;IAElBJ,SAAS,EAAEA,SAAS;IACpBJ,KAAK,EAAEsC,YAAY;IACnB/B,aAAa,EAAEA,aAAa;IAC5BG,WAAW,EAAEA,WAAW;IACxBqD,SAAS,EAAE,KAAK;IAChBnC,IAAI,EAAEL,MAAM;IACZyC,iBAAiB;IACjBC,SAAS,EAAErD;EAAe,GACtBH,WAAW,GAEfpC,KAAA,CAAAiF,aAAA,CAAC3E,iBAAiB;IAACuF,WAAW,EAAEjB;EAAe,GAG7C5E,KAAA,CAAAiF,aAAA;IAAKG,OAAO,EAAE9B;EAAK,GACjBtD,KAAA,CAAAiF,aAAA,CAAC1E,IAAI;IAACuF,EAAE,EAAE5C,MAAM;IAAE6C,MAAM;EAAA,GACtB/F,KAAA,CAAAiF,aAAA,CAACpE,KAAK;IACJc,KAAK,EAAEc,YAAY;IACnBf,SAAS,EAAEhB,EAAE,CAACgC,OAAO,CAACb,OAAO,EAAE;MAC7B,CAACa,OAAO,CAACsD,cAAc,GAAGpD,eAAe,KAAK;KAC/C,CAAC;IACFqD,SAAS,EAAEzC,oBAAoB;IAC/B0C,SAAS,EAAE;EAAC,GAEZlG,KAAA,CAAAiF,aAAA,CAACjE,eAAe,CAACmF,QAAQ;IAACC,KAAK,EAAEjF;EAAO,GACtCnB,KAAA,CAAAiF,aAAA,CAACzE,OAAO;IAAC6F,OAAO,EAAEtD;EAAU,GAAGlB,OAAO,CAAW,CACxB,CACrB,CACH,CACH,CACY,CAEvB,CACG;AAEV,CAAC,CAAC;AAEFN,QAAQ,CAAC+E,YAAY,GAAG;EACtBtE,gBAAgB,EAAE,KAAK;EACvBC,gBAAgB,EAAE,IAAI;EACtBC,aAAa,EAAE,KAAK;EACpBG,WAAW,EAAE,KAAK;EAClBG,OAAO,EAAEzB,IAAI;EACbuB,MAAM,EAAEvB,IAAI;EACZgB,SAAS,EAAE,YAAY;EACvBI,aAAa,EAAE;CAChB;AAEDZ,QAAQ,CAACgF,WAAW,GAAG,UAAU;AAEjC,eAAehF,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}