{"ast":null,"code":"import React, { createRef, useContext, useEffect, useState, useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { TreeViewContext } from './TreeViewContainer';\nimport { useTree } from './useTree';\nimport Zoom from './Zoom';\nimport styles from './styles';\nimport { useZoom } from './useZoom';\nimport { DEFAULT_SCALE_EXTENT, ZERO_VECTOR2, TreeViewPropsDefaults } from './variables';\nimport { TreeViewSvg } from './TreeViewSvg';\nimport { useFinalMargins } from './useFinalMargins';\nimport { usePropDeprecationWarning } from '../utils/use-deprecation-warnings';\nconst useStyles = makeStyles(styles, {\n  name: 'PicassoTreeView'\n});\nexport const TreeView = props => {\n  var _a, _b, _c;\n  usePropDeprecationWarning({\n    props,\n    name: 'centerTranslation',\n    componentName: 'TreeView',\n    description: 'If you happen to rely on it, you are likely would want to migrate to StaticTreeView component instead of TreeView'\n  });\n  usePropDeprecationWarning({\n    props,\n    name: 'transitionDuration',\n    componentName: 'TreeView',\n    description: 'If you happen to rely on it, you are likely would want to migrate to StaticTreeView component instead of TreeView'\n  });\n  const {\n    data,\n    renderNode,\n    nodeWidth = TreeView.defaultProps.nodeWidth,\n    nodeHeight = TreeView.defaultProps.nodeHeight,\n    scaleExtent = TreeView.defaultProps.scaleExtent,\n    initialScale = TreeView.defaultProps.initialScale,\n    scaleCoefficient = TreeView.defaultProps.scaleCoefficient,\n    showZoom = TreeView.defaultProps.showZoom,\n    // NOTE: these two are intentionally removed from defaultProps in order\n    // to make usePropDeprecationWarning hook correctly detect their usage\n    centerTranslation = ZERO_VECTOR2,\n    transitionDuration = 750\n  } = props;\n  const {\n    direction = TreeView.defaultProps.directionProps.direction,\n    variant = TreeView.defaultProps.directionProps.variant\n  } = (_a = props.directionProps) !== null && _a !== void 0 ? _a : TreeView.defaultProps.directionProps;\n  const classes = useStyles();\n  const rootRef = createRef();\n  const [verticalMargin, horizontalMargin] = useFinalMargins(direction, (_b = props.directionProps) === null || _b === void 0 ? void 0 : _b.verticalMargin, (_c = props.directionProps) === null || _c === void 0 ? void 0 : _c.horizontalMargin);\n  const {\n    nodes,\n    links,\n    selectedNode\n  } = useTree({\n    data,\n    direction,\n    verticalMargin,\n    horizontalMargin,\n    nodeWidth,\n    nodeHeight,\n    variant\n  });\n  const center = useMemo(() => {\n    var _a, _b;\n    if (!selectedNode) {\n      return ZERO_VECTOR2;\n    }\n    const {\n      x: xPosition,\n      y: yPosition,\n      data: nodeData\n    } = selectedNode;\n    return {\n      x: xPosition + nodeWidth / 2 + (((_a = nodeData.selectedOffset) === null || _a === void 0 ? void 0 : _a.x) || 0),\n      y: yPosition + nodeHeight / 2 + (((_b = nodeData.selectedOffset) === null || _b === void 0 ? void 0 : _b.y) || 0)\n    };\n  }, [selectedNode, nodeWidth, nodeHeight]);\n  const {\n    handleZoom,\n    zoom\n  } = useZoom({\n    rootRef,\n    scaleExtent,\n    center: {\n      x: center.x + centerTranslation.x,\n      y: center.y + centerTranslation.y\n    },\n    transitionDuration,\n    initialScale\n  });\n  const [initialized, setInitialized] = useState(false);\n  const {\n    updateState\n  } = useContext(TreeViewContext);\n  useEffect(() => {\n    if (!rootRef.current || initialized || !zoom) {\n      return;\n    }\n    updateState({\n      ref: rootRef.current,\n      zoom\n    });\n    setInitialized(true);\n  }, [rootRef, initialized, zoom, updateState]);\n  return React.createElement(\"div\", {\n    className: classes.root\n  }, showZoom && React.createElement(Zoom, {\n    handleZoom: handleZoom,\n    scaleCoefficient: scaleCoefficient\n  }), React.createElement(TreeViewSvg, {\n    ref: rootRef,\n    nodes: nodes,\n    links: links,\n    direction: direction,\n    verticalMargin: verticalMargin,\n    horizontalMargin: horizontalMargin,\n    renderNode: renderNode,\n    svgProps: {\n      className: classes.svg\n    }\n  }));\n};\nTreeView.defaultProps = Object.assign(Object.assign({}, TreeViewPropsDefaults), {\n  scaleExtent: DEFAULT_SCALE_EXTENT,\n  initialScale: 1,\n  scaleCoefficient: 0.5,\n  showZoom: true\n});\nTreeView.displayName = 'TreeView';\nexport default TreeView;","map":{"version":3,"names":["React","createRef","useContext","useEffect","useState","useMemo","makeStyles","TreeViewContext","useTree","Zoom","styles","useZoom","DEFAULT_SCALE_EXTENT","ZERO_VECTOR2","TreeViewPropsDefaults","TreeViewSvg","useFinalMargins","usePropDeprecationWarning","useStyles","name","TreeView","props","componentName","description","data","renderNode","nodeWidth","defaultProps","nodeHeight","scaleExtent","initialScale","scaleCoefficient","showZoom","centerTranslation","transitionDuration","direction","directionProps","variant","_a","classes","rootRef","verticalMargin","horizontalMargin","_b","_c","nodes","links","selectedNode","center","x","xPosition","y","yPosition","nodeData","selectedOffset","handleZoom","zoom","initialized","setInitialized","updateState","current","ref","createElement","className","root","svgProps","svg","Object","assign","displayName"],"sources":["../../src/TreeView/TreeView.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}